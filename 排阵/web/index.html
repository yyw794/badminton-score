<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>羽毛球比赛记分</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="app">
        <!-- 头部 -->
        <header class="header">
            <h1>🏸 科技球队日常训练</h1>
            <p class="subtitle">比赛记分系统</p>
        </header>

        <!-- 活动信息 -->
        <div class="event-info">
            <div class="info-row">
                <span class="label">活动名称：</span>
                <span class="value" id="event-name">2026 马年首秀战</span>
                <button class="edit-btn" onclick="editEventName()">✏️</button>
            </div>
            <div class="info-row">
                <span class="label">场地数：</span>
                <span class="value" id="court-count">3 个</span>
            </div>
            <div class="info-row">
                <span class="label">赛制：</span>
                <span class="value">15 分/局，2 局</span>
            </div>
        </div>

        <!-- 场地选择 Tab -->
        <div class="tabs">
            <button class="tab active" data-court="1" onclick="switchCourt(1)">1 号场地</button>
            <button class="tab" data-court="2" onclick="switchCourt(2)">2 号场地</button>
            <button class="tab" data-court="3" onclick="switchCourt(3)">3 号场地</button>
        </div>

        <!-- 比赛列表 -->
        <div class="matches-container">
            <div class="court-section" id="court-1">
                <h2 class="court-title">📍 1 号场地</h2>
                <div class="matches-list" id="matches-1"></div>
            </div>
            <div class="court-section" id="court-2" style="display:none;">
                <h2 class="court-title">📍 2 号场地</h2>
                <div class="matches-list" id="matches-2"></div>
            </div>
            <div class="court-section" id="court-3" style="display:none;">
                <h2 class="court-title">📍 3 号场地</h2>
                <div class="matches-list" id="matches-3"></div>
            </div>
        </div>

        <!-- 比分录入弹窗 -->
        <div class="modal" id="score-modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>录入比分</h3>
                    <button class="close-btn" onclick="closeModal()">✕</button>
                </div>
                <div class="modal-body">
                    <div class="match-info" id="modal-match-info"></div>
                    
                    <div class="score-input-section">
                        <div class="team-score">
                            <label>队伍 A</label>
                            <div class="score-inputs">
                                <input type="number" id="score-a1" placeholder="第 1 局" min="0" max="20">
                                <input type="number" id="score-a2" placeholder="第 2 局" min="0" max="20">
                            </div>
                        </div>
                        <div class="vs">VS</div>
                        <div class="team-score">
                            <label>队伍 B</label>
                            <div class="score-inputs">
                                <input type="number" id="score-b1" placeholder="第 1 局" min="0" max="20">
                                <input type="number" id="score-b2" placeholder="第 2 局" min="0" max="20">
                            </div>
                        </div>
                    </div>

                    <div class="quick-scores">
                        <p class="quick-title">快速选择：</p>
                        <button class="quick-btn" onclick="setQuickScore(15,13,11,15)">15:13, 11:15</button>
                        <button class="quick-btn" onclick="setQuickScore(15,8,15,10)">15:8, 15:10</button>
                        <button class="quick-btn" onclick="setQuickScore(15,14,15,13)">15:14, 15:13</button>
                        <button class="quick-btn" onclick="setQuickScore(15,10,12,15)">15:10, 12:15</button>
                    </div>

                    <button class="save-btn" onclick="saveScore()">💾 保存比分</button>
                    <button class="clear-btn" onclick="clearScore()">🗑️ 清空比分</button>
                </div>
            </div>
        </div>

        <!-- 底部操作栏 -->
        <div class="action-bar">
            <button class="action-btn" onclick="showStats()">📊 统计</button>
            <button class="action-btn" onclick="showAnalysis()">📈 分析</button>
            <button class="action-btn" onclick="exportData()">📤 导出</button>
            <button class="action-btn" onclick="importData()">📥 导入</button>
            <button class="action-btn primary" onclick="generatePoster()">🖼️ 海报</button>
        </div>

        <!-- 统计弹窗 -->
        <div class="modal" id="stats-modal">
            <div class="modal-content stats-content">
                <div class="modal-header">
                    <h3>📊 球员统计</h3>
                    <button class="close-btn" onclick="closeStatsModal()">✕</button>
                </div>
                <div class="modal-body">
                    <div class="stats-tabs">
                        <button class="stats-tab active" onclick="switchStatsTab('all')">全部</button>
                        <button class="stats-tab" onclick="switchStatsTab('male')">男球员</button>
                        <button class="stats-tab" onclick="switchStatsTab('female')">女球员</button>
                    </div>
                    <div class="stats-list" id="stats-list"></div>
                    <div class="stats-actions">
                        <button class="action-btn-small" onclick="resetData()">🔄 重置数据</button>
                        <button class="action-btn-small" onclick="simulateAllMatches()">🎲 模拟所有比赛</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- 战绩分析弹窗 -->
        <div class="modal" id="analysis-modal">
            <div class="modal-content stats-content">
                <div class="modal-header">
                    <h3>📈 战绩分析</h3>
                    <button class="close-btn" onclick="closeAnalysisModal()">✕</button>
                </div>
                <div class="modal-body">
                    <div class="analysis-filter">
                        <label>选择球员：</label>
                        <select id="analysis-player-select" onchange="renderAnalysis()">
                            <option value="">-- 全部球员 --</option>
                        </select>
                    </div>
                    <div class="analysis-summary" id="analysis-summary"></div>
                    <div class="analysis-list" id="analysis-list"></div>
                </div>
            </div>
        </div>

        <!-- 海报生成区域（隐藏，用于截图） -->
        <div class="poster-container" id="poster-container" style="display:none;">
            <div class="poster" id="poster">
                <div class="poster-header">
                    <h1>🏸 科技球队日常训练</h1>
                    <p class="poster-event-name" id="poster-event-name">2026 马年首秀战</p>
                    <p class="poster-date" id="poster-date"></p>
                </div>
                <div class="poster-summary" id="poster-summary"></div>
                <div class="poster-matches" id="poster-matches"></div>
            </div>
        </div>
    </div>

    <!-- 导入文件输入 -->
    <input type="file" id="import-file" accept=".json" style="display:none;" onchange="handleFileImport(event)">

    <!-- html2canvas 用于截图 -->
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

    <script src="app.js?v=20260227"></script>
</body>
</html>
