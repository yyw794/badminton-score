# 羽毛球排阵系统需求文档

## 1. 项目概述

### 1.1 项目名称
科技球队日常训练活动 - 羽毛球排阵系统

### 1.2 项目背景
为科技球队日常训练活动提供自动化的羽毛球比赛排阵功能，生成公平、平衡的对阵表，并支持导出 Excel 格式便于打印和使用。

### 1.3 适用范围
- 混合双打、男子双打、女子双打三种比赛类型
- 支持 2-3 个场地的训练活动
- 适用于 12 人以上的球队训练

---

## 2. 功能需求

### 2.1 球员管理

#### 2.1.1 球员名单
- **男性球员**：苏大哲、罗蒙、江锐、严勇文、陈顺星、陈小洪、卢志辉、林锋、王小波、刘继宇、董广博、林琪琛、罗琴荩（共 13 人）
- **女性球员**：田茜、唐英武、李祺祺、高洁、滕菲、谢卓珊、崔倩男、林小连（共 8 人）

#### 2.1.2 混双资格
仅限以下男性球员可参加混合双打：
- 林锋、王小波、陈顺星、罗琴荩

#### 2.1.3 报名解析
- 支持从微信接龙文本中解析报名名单
- 自动识别并过滤无效行（空行、注释、日期等）
- 支持处理带序号的报名格式（如"1.张三"或"1，张三"）

### 2.2 比赛配置

#### 2.2.1 场地数量
- 根据总人数自动确定：
  - ≤12 人：2 个场地
  - >12 人：3 个场地

#### 2.2.2 比赛参数
- 每场地比赛数：6 场
- 球员最大参赛场次：5 场
- 训练时长：2 小时
- 赛制：15 分/局，2 局

### 2.3 排阵规则

#### 2.3.1 基本规则（最高优先级）
1. **同一轮次中，同一球员只能在一场比赛中出现**（物理约束，不可违反）
   - 例如：某球员在第 1 轮第 1 场地参赛，则不能在第 1 轮的其他场地参赛
   - 这是排阵的基础约束，必须首先满足

2. 每位球员的参赛场次不超过最大限制（5 场）

3. 优先满足有特殊要求的球员的固定场次需求

#### 2.3.2 特殊约束

**固定场次要求**：
| 球员 | 固定场次 | 提前离场 |
|------|----------|----------|
| 严勇文 | 3 场 | 是 |
| 崔倩男 | 4 场 | 是 |

**固定搭档要求**：
| 搭档组合 | 优先级权重 |
|----------|------------|
| 苏大哲 + 罗蒙 | 5 |

- 权重越高，越优先安排搭档出场

#### 2.3.3 平衡算法
排阵系统使用评分算法确保：
1. 球员参赛场次尽量均衡
2. 有特殊需求的球员优先安排
3. 固定搭档组合优先安排

### 2.4 输出需求

#### 2.4.1 Excel 对阵表
**主表（对阵表）**：
- 表头：科技球队日常训练活动 - 对阵表
- 配置信息：场地数、时长、赛制、项目
- 列定义：
  | 列名 | 说明 |
  |------|------|
  | 轮次 | 比赛轮次编号 |
  | 场地 | 场地编号（1 号、2 号、3 号） |
  | 类型 | 男双/女双/混双 |
  | 对阵 A | A 方球员（用/分隔） |
  | 比分 A | A 方得分（留空待填写） |
  | 比分 B | B 方得分（留空待填写） |
  | 对阵 B | B 方球员（用/分隔） |

**样式要求**：
- 字体：微软雅黑
- 标题：18 号加粗
- 表头：11 号加粗，绿色背景
- 内容：10 号，居中对齐
- 边框：细线边框
- 行高：32
- 纸张：A4 横向打印

#### 2.4.2 球员统计表（可选）
- 表头：球员参赛场次统计
- 列定义：
  | 列名 | 说明 |
  |------|------|
  | 姓名 | 球员姓名 |
  | 总场次 | 总参赛场次 |
  | 男双 | 男子双打场次 |
  | 女双 | 女子双打场次 |
  | 混双 | 混合双打场次 |

---

## 3. 技术需求

### 3.1 开发语言
- Python 3.10+

### 3.2 依赖库
- openpyxl >= 3.0.0：Excel 文件生成

### 3.3 输入输出
- **输入**：微信接龙文本文件（`微信接龙.txt`）
- **输出**：Excel 对阵表（`对阵表.xlsx`）

### 3.4 运行环境
- 支持 macOS、Linux、Windows
- 需要安装 Python 3.10+ 和依赖库

---

## 4. 使用流程

1. **准备报名名单**
   - 将微信接龙内容保存到 `微信接龙.txt`

2. **运行排阵程序**
   ```bash
   python lineup_scheduler.py
   ```

3. **查看输出**
   - 控制台输出：球员统计、比赛分布等信息
   - Excel 文件：`排阵/对阵表.xlsx`

4. **打印使用**
   - 打开 Excel 文件
   - A4 横向打印对阵表
   - 现场填写比分

---

## 5. 扩展需求（可选）

### 5.1 配置扩展
- 支持通过配置文件或命令行参数调整：
  - 球员名单
  - 特殊约束
  - 比赛参数

### 5.2 数据导出
- 支持导出 JSON 格式数据
- 支持从 JSON 导入历史数据

### 5.3 Web 界面
- 可视化报名管理
- 在线排阵和预览
- 移动端记分功能

---

## 6. 版本历史

| 版本 | 日期 | 变更内容 |
|------|------|----------|
| 1.0 | 2026-02-28 | 初始版本：基础排阵功能、Excel 输出 |
